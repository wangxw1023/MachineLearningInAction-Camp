
### 信息增益的定义

特征$A$对训练集$D$的信息增益$g(D,A)$，定义为集合$D$的经验熵$H(D)$与特征$A$给定条件下$D$的经验条件熵$H(D|A)$之差，即  
               $$g(D,A) = H(D) - H(D|A)$$

### 信息增益的算法流程

设训练数据集为$D$，$|D|$表示其样本容量，即样本个数。设有$K$个类$C_k$，$k=1,2,…,K$，$|C_k|$为属于类$C_k$的样本个数，$\sum_{k=1}^K|C_k|=|D|$。
设特征$A$有$n$个不同的取值${a_1,a_2,…,a_n}$，根据特征$A$的取值将$D$划分为$n$个子集$D_1,D_2,…,D_n$，$|D_i|$为$D_i$的样本个数，$\sum_{i=1}^n|D_i|=|D|$。  
记子集$D_i$中属于类$C_k$的样本的集合为$D_ik$，即$D_ik=D_i\bigcap C_k$，$|D_ik|$为$D_ik$的样本个数，于是信息增益的算法如下：  
输入：训练数据集$D$和特征$A$；  
输出：特征$A$对训练数据集$D$的信息增益$g(D,A)$。  
（1）计算数据集$D$的经验熵$H(D)$   
$$H(D) = -\sum_{k=1}^K\frac{|C_k|}{|D|}log_2\frac{|C_k|}{|D|}$$
（2）计算特征$A$对数据集$D$的经验条件熵$H(D|A)$
$$H(D|A) = \sum_{i=1}^n\frac{|D_i|}{|D|}H(D_i)=-\sum_{i=1}^n\frac{|D_i|}{|D|}\sum_{k=1}^K\frac{|D_{ik}|}{|D_i|}log_2\frac{|D_{ik}|}{|D_i|}$$
（3）计算信息增益
$$g(D,A) = H(D) - H(D|A)$$


### 作业：在构建一个决策树模型时，我们对某个属性分割节点，四张图中，哪个属性对应的信息增益最大？

首先，由于四张图中，只给出了按属性分割后的结果，难以获得原始数据集，故没有通过代码来实现。   
通过四张图可以获得的信息有：数据集$D$的样本个数为14，分两类，‘yes’类的样本个数为9，‘no’类的样本个数为5；  
包含了四个特征：outlook、humidity、windy、temperature，分别以$A_1$、$A_2$、$A_3$、$A_4$表示。
首先计算数据集$D$的经验熵$H(D)$：
$$H(D)=-\frac{9}{14}log_2\frac{9}{14}-\frac{5}{14}log_2\frac{5}{14} =0.94 $$
然后计算各特征对数据集$D$的信息增益，则  
（1）outlook  
$g(D,A_1)=H(D)-[\frac{5}{14}H(D_1)+\frac{4}{14}H(D_2)+\frac{5}{14}H(D_3)]$  
$=0.94-[\frac{5}{14}(-\frac{2}{5}log_2\frac{2}{5}-\frac{3}{5}log_2\frac{3}{5})+\frac{4}{14}(-\frac{5}{5}log_2\frac{5}{5})+\frac{5}{14}(-\frac{3}{5}log_2\frac{3}{5}-\frac{2}{5}log_2\frac{2}{5})]$
$=0.94-0.694=0.246$  
  
（2）humidity  
$g(D,A_2)=H(D)-[\frac{7}{14}H(D_1)+\frac{7}{14}H(D_2)]$  
$=0.94-[\frac{7}{14}(-\frac{3}{7}log_2\frac{3}{7}-\frac{4}{7}log_2\frac{4}{7})+\frac{7}{14}(-\frac{6}{7}log_2\frac{6}{7}-\frac{1}{7}log_2\frac{1}{7})]$
$=0.94-0.7885=0.152$  
  
（3）windy 
$g(D,A_3)=H(D)-[\frac{8}{14}H(D_1)+\frac{6}{14}H(D_2)]$  
$=0.94-[\frac{8}{14}(-\frac{6}{8}log_2\frac{6}{8}-\frac{2}{8}log_2\frac{2}{8})+\frac{6}{14}(-\frac{3}{6}log_2\frac{3}{6}-\frac{3}{6}log_2\frac{3}{6})]$
$=0.94-0.892=0.048$  
  
（4）temperature  
$g(D,A_4)=H(D)-[\frac{4}{14}H(D_1)+\frac{6}{14}H(D_2)+\frac{4}{14}H(D_3)]$  
$=0.94-[\frac{4}{14}(-\frac{2}{4}log_2\frac{2}{4}-\frac{2}{4}log_2\frac{2}{4})+\frac{6}{14}(-\frac{4}{6}log_2\frac{4}{6}-\frac{2}{6}log_2\frac{2}{6})+\frac{4}{14}(-\frac{3}{4}log_2\frac{3}{4}-\frac{1}{4}log_2\frac{1}{4})]$
$=0.94-0.9115=0.028$    
综上可得：outlook属性对应的信息增益最大。
